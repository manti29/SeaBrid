var table = null;
$(function () {
    bindQuery()
});
function bindQuery() {
    $("#query").click(function () {
        0 != $("input#username").val().replace(/(^s*)|(s*$)/g, "").length && ($("#roles").removeClass("hidden"), reloadTable())
    })
}
function reloadTable() {
    null != table && table.destroy();
    table = initTable()
}
function initTable() {
    var a = $("#table-roles").DataTable({
        pagingType: "simple_numbers",
        language: {url: "../../static/datatables/locale/zh_CN.txt"},
        ajax: "../../api/admin/users/" + encodeURI($("input#username").val()) + "/roles/",
        columns: [{data: "roleId"}, {data: "roleName"}, {data: "branchName"}, {data: "bizLine"}, {data: "startDate"}, {data: "endDate"}, {data: "status"}],
        columnDefs: [{type: "chinese", targets: [1, 2, 3, 6]}, {searchable: !1, visible: !1, targets: 0}],
        order: [[2, "asc"], [1, "asc"]]
    });
    a.on("order.dt search.dt", function () {
        a.column(0,
            {search: "applied", order: "applied"}).nodes().each(function (a, b) {
            a.innerHTML = b + 1
        })
    }).draw();
    return a
};
